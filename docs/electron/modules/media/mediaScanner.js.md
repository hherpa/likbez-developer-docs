# modules/media/mediaScanner.js

## Описание

Сканер медиафайлов Electron приложения Likbez. Отвечает за сканирование директорий, получение информации о медиафайлах и очистку неиспользуемых файлов.

## Основные функции

### constructor()

Инициализирует сканер медиафайлов:

- Получает путь к корневой директории данных

### listNodeMedia(nodeDir)

Получает список медиафайлов узла:

- Проверяет существование директории узла
- Сканирует директорию узла на наличие медиафайлов
- Возвращает массив файлов с именем, относительным путем и полным путем
- Возвращает пустой массив при ошибке

### listMediaFiles()

Получает список всех медиафайлов:

- Рекурсивно сканирует все директории начиная с dataRoot
- Вызывает приватный метод _scanDirectoryForMedia
- Возвращает массив всех медиафайлов

### _scanDirectoryForMedia(dir, results)

Рекурсивно сканирует директорию на наличие медиафайлов:

- Сканирует содержимое директории
- Добавляет медиафайлы в результаты
- Рекурсивно сканирует поддиректории
- Игнорирует ошибки

### getMediaInfo(relPath)

Получает информацию о медиафайле:

- Определяет абсолютный путь к файлу
- Проверяет существование файла
- Получает статистику файла
- Возвращает информацию о файле (имя, размер, расширение, даты создания/модификации, тип)

### cleanupUnusedMedia(usedPaths)

Очищает неиспользуемые медиафайлы:

- Получает список всех медиафайлов
- Сравнивает с использованными путями
- Удаляет неиспользуемые файлы
- Возвращает количество удаленных файлов

### getNodeMedia(nodeDir)

Получает медиафайлы узла:

- Вызывает listNodeMedia для получения файлов узла
- Возвращает первый файл из списка или null

## Поддерживаемые типы файлов

### Изображения
- png, jpg, jpeg, gif, webp

### Видео
- mp4, webm, ogg

### Документы
- pdf, txt

## Импорты

- path: модуль для работы с путями файловой системы
- fs: модуль для работы с файловой системой
- fsp: промисы для работы с файловой системой
- FileUtils из ../utils: утилиты для работы с файлами
- MimeUtils из ../utils: утилиты для работы с MIME типами