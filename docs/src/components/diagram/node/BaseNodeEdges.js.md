# BaseNodeEdges

## Назначение компонента

`BaseNodeEdges.js` - это React-хук, который предоставляет логику работы с ребрами (edges) в диаграмме узлов. Он управляет состоянием соединений между узлами, обрабатывает изменения и создание новых соединений.

## Основные функции и методы

### Хук `useNodeEdges()`

Основной экспорт файла - хук `useNodeEdges()`, который возвращает объект со следующими свойствами:

- `nodes` - состояние узлов
- `setNodes` - функция установки состояния узлов
- `edges` - состояние ребер
- `setEdges` - функция установки состояния ребер
- `onNodesChange` - обработчик изменений узлов
- `onEdgesChange` - обработчик изменений ребер
- `onConnect` - обработчик создания новых соединений

### Константы

#### `DEFAULT_EDGE_OPTIONS`
Дефолтные опции для ребер:
- `type: 'step'` - тип соединения
- `style` - стили соединения (ширина линии, цвет, переход)
- `selectable: true` - возможность выделения

#### `EDGE_COLORS`
Цветовая палитра для ребер:
- `default: '#e5e7eb'` - стандартный цвет
- `hover: '#d1d5db'` - цвет при наведении
- `selected: '#94a3b8'` - цвет выделенного ребра

## Структура и логика работы с ребрами

### Управление состоянием
Хук использует `useState` для управления состоянием узлов и ребер:
```javascript
const [nodes, setNodes] = useState([]);
const [edges, setEdges] = useState([]);
```

### Обработчики изменений

#### `onNodesChange`
Простой обработчик изменений узлов, использующий `applyNodeChanges` из reactflow.

#### `onEdgesChange`
Более сложный обработчик, который:
1. Применяет изменения с помощью `applyEdgeChanges`
2. Обновляет стиль ребер в зависимости от их выделения
3. Формирует карту выделенных ребер для обновления data-атрибутов узлов
4. Обновляет узлы с информацией о связанных выделенных ребрах

#### `onConnect`
Обработчик создания новых соединений, использующий `addEdge` с дефолтными опциями.

## Взаимодействие с другими компонентами

Хук предназначен для использования в компонентах диаграммы узлов и взаимодействует с:
- Компонентами узлов через состояние `nodes`
- Компонентами ребер через состояние `edges`
- ReactFlow API через функции `applyNodeChanges`, `applyEdgeChanges`, `addEdge`

## Используемые зависимости

- `react` - основной фреймворк
- `reactflow` - библиотека для работы с диаграммами узлов
  - `applyNodeChanges` - применение изменений к узлам
  - `applyEdgeChanges` - применение изменений к ребрам
  - `addEdge` - добавление новых ребер

## Архитектурная диаграмма

```mermaid
graph TD
    A[BaseNodeEdges] --> B[useNodeEdges Hook]
    B --> C[Состояние nodes]
    B --> D[Состояние edges]
    B --> E[onNodesChange]
    B --> F[onEdgesChange]
    B --> G[onConnect]
    F --> H[Обновление стилей]
    F --> I[Обновление узлов]
    G --> J[Добавление ребер]