# MarkdownUpdater.js

## Назначение
Модуль для обновления контента с markdown разметкой в редакторе, отвечающий за обновление markdown элементов.

## Экспортируемые компоненты
- `updateContentWithMarkdown` - основная функция обновления контента с markdown

## Структура
1. Импорты констант, утилит и логгера
2. Константы префиксов заголовков
3. Вспомогательные функции:
   - `getHeaderPrefix` - получение префикса заголовка
   - `isHeaderType` - проверка, является ли тип заголовком
4. Основная функция `updateContentWithMarkdown` для обновления контента

## Взаимодействия
1. Принимает тип markdown, выделенный текст, элемент, позицию элемента, оригинальный контент, функцию onChange и contentEditable элемент
2. Разбивает оригинальный контент на строки
3. Находит целевую строку по позиции
4. Получает текст из contentEditable элемента
5. Обрабатывает различные типы markdown:
   - Параграфы
   - Заголовки с выделенным текстом
   - Заголовки без выделения
   - Другие markdown типы в параграфах
6. Вызывает onChange с новым контентом

## Зависимости
- `../../../constants` - для получения шаблонов и текстов по умолчанию
- `LineProcessor.js` - для поиска строк по позиции
- `ContentEditableUtils.js` - для получения текста из contentEditable
- `TextRemover.js` - для удаления текста из markdown
- `Logger.js` - для логирования

## Архитектура
Следует принципу единственной ответственности (SRP), отвечая только за обновление markdown. Использует вспомогательные функции для работы с заголовками.

Функция `updateContentWithMarkdown` реализует логику:
1. Проверяет валидность параметров (onChange и elementPosition)
2. Разбивает оригинальный контент на строки
3. Находит целевую строку по позиции
4. Получает текст из contentEditable элемента
5. Обрабатывает параграфы: создает новый элемент после целевой строки
6. Получает шаблон для типа markdown
7. Обрабатывает заголовки с выделенным текстом:
   - Создает новый заголовок после целевой строки
   - Удаляет выделенный текст из текущей строки
   - Обновляет contentEditable элемент
8. Обрабатывает заголовки без выделения: обновляет текущую строку
9. Обрабатывает другие markdown типы в параграфах: разбивает текст на строки
10. Вызывает onChange с новым контентом
11. Обрабатывает ошибки с логированием