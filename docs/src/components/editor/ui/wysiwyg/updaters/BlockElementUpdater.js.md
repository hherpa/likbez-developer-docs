# BlockElementUpdater.js

## Назначение
Модуль для обновления строк с block-элементами в редакторе, обеспечивающий замену содержимого block-элементов в markdown строках.

## Экспортируемые компоненты
- `updateBlockElementLine` - функция обновления строки с block-элементом

## Структура
1. Импорты классификаторов и утилит
2. Функция `updateBlockElementLine` для обновления строки с block-элементом

## Взаимодействия
1. Принимает новый текст, элемент, массив строк и индекс целевой строки
2. Использует ElementClassifier для получения тега элемента
3. Использует ElementInserter для построения текста вставки
4. Работает с регулярными выражениями для поиска элементов
5. Обновляет содержимое строк в массиве

## Зависимости
- `ElementClassifier.js` - для получения тега элемента
- `ElementInserter.js` - для построения текста вставки

## Архитектура
Следует принципу единственной ответственности (SRP), отвечая только за обновление строк с block-элементами.

Функция `updateBlockElementLine` реализует логику:
1. Получает текущую строку из массива строк
2. Получает тег элемента через getElementTag
3. Экранирует специальные символы в теге для regex
4. Создает паттерн для поиска элемента
5. Нормализует тип элемента (boxLatex -> box-latex)
6. Строит текст нового элемента через buildInsertText
7. Если текст элемента построен успешно:
   - Если строка содержит только элемент, заменяет всю строку
   - Иначе заменяет элемент в строке
8. Если текст элемента не построен:
   - Ищет элемент в строке через регулярное выражение
   - Если найден, заменяет на новый формат
   - Иначе заменяет строку на новый текст