# useNodeNavigation.js

## Обзор

Пользовательский React хук для навигации к узлу на холсте ReactFlow. Обеспечивает плавную анимацию перехода к указанному узлу на диаграмме.

## Назначение

useNodeNavigation отвечает за:
- Анимацию перехода к узлу на холсте ReactFlow
- Центрирование холста на указанном узле
- Управление масштабом при навигации

## Зависимости

Хук использует следующие модули и хуки:
- `useCallback` из React - для мемоизации функции навигации
- `rfInstance` - инстанс ReactFlow для управления холстом

## Возвращаемое значение

Хук возвращает объект с одним свойством:

### navigateToNode
Функция для навигации к узлу:
```javascript
const navigateToNode = useCallback((node) => {
  // ... логика навигации
}, [rfInstance]);
```

Функция принимает:
- `node` - объект узла для навигации с обязательным свойством `id`

!> Используется мемоизация для оптимизации производительности

## Логика работы

### Проверка наличия данных
Функция проверяет наличие необходимых данных:
```javascript
if (!rfInstance || !node?.id) return;
```

### Получение узла
Функция получает узел из инстанса ReactFlow:
```javascript
const targetNode = rfInstance.getNode?.(node.id);
if (!targetNode) return;
```

### Вычисление позиции
Функция вычисляет центр узла для центрирования:
```javascript
const abs = targetNode.positionAbsolute || targetNode.position || { x: 0, y: 0 };
const centerX = abs.x + (targetNode.width || 0) / 2;
const centerY = abs.y + (targetNode.height || 0) / 2;
```

!> Жестко закодированное значение по умолчанию `{ x: 0, y: 0 }` может быть неожиданным поведением

### Центрирование холста
Функция центрирует холст на узле:
```javascript
if (typeof rfInstance.setCenter === 'function') {
  rfInstance.setCenter(centerX, centerY, { zoom: 1.5, duration: 600 });
}
```

!> Жестко закодированные значения zoom (1.5) и duration (600) могут потребовать настройки

## Использование

Хук используется в различных компонентах для навигации к узлам:
```javascript
const { navigateToNode } = useNodeNavigation(rfInstance);
```

Функция вызывается при необходимости навигации:
```javascript
navigateToNode(targetNode);
```

## Интеграция с ReactFlow

### getNode
Используется для получения информации об узле:
```javascript
const targetNode = rfInstance.getNode?.(node.id);
```

### setCenter
Используется для центрирования холста:
```javascript
rfInstance.setCenter(centerX, centerY, { zoom: 1.5, duration: 600 });
```

## Принципы работы

1. **Интеграция** - использует существующий API ReactFlow
2. **Оптимизация** - использование useCallback для предотвращения лишних созданий функций
3. **Безопасность** - проверка наличия необходимых данных перед выполнением
4. **Плавность** - использование анимации для улучшения UX

## Особенности реализации

!> Жестко закодированные значения zoom (1.5) и duration (600) не настраиваются извне
!> Отсутствует обработка ошибок при выполнении навигации
!> Использование `positionAbsolute` может быть несовместимо с некоторыми версиями ReactFlow
!> Жестко закодированное значение по умолчанию `{ x: 0, y: 0 }` может быть неожиданным поведением