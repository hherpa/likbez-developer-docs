# useUI.js

## Обзор

Пользовательский React хук для управления UI состоянием приложения. Обеспечивает централизованное управление состоянием меню, выбранных узлов и инстанса ReactFlow.

## Назначение

useUI отвечает за:
- Управление состоянием открытого/закрытого меню
- Управление состоянием выбранного узла
- Хранение инстанса ReactFlow для последующего использования
- Предоставление функций для управления UI состоянием

## Зависимости

Хук использует следующие модули и хуки:
- `useState` из React - для управления локальным состоянием
- `useCallback` из React - для мемоизации функций управления

## Возвращаемое значение

Хук возвращает объект со следующими свойствами:

### Состояние меню
- `menuOpen` - булево значение, указывающее открыто ли меню
- `setMenuOpen` - функция для установки состояния меню
- `selectedNode` - объект выбранного узла или null
- `setSelectedNode` - функция для установки выбранного узла

### Инстанс ReactFlow
- `rfInstance` - инстанс ReactFlow (изначально null)
- `setRfInstance` - функция для установки инстанса ReactFlow

### Функции управления
- `closeMenu` - функция для закрытия меню и сброса выбранного узла
- `openMenu` - функция для открытия меню и установки выбранного узла

## Логика работы

### Инициализация состояния
Хук инициализирует начальное состояние:
```javascript
const [menuOpen, setMenuOpen] = useState(false);
const [selectedNode, setSelectedNode] = useState(null);
const [rfInstance, setRfInstance] = useState(null);
```

### closeMenu
Функция для закрытия меню и сброса выбранного узла:
```javascript
const closeMenu = useCallback(() => {
  setMenuOpen(false);
  setSelectedNode(null);
}, []);
```

!> Используется мемоизация для оптимизации производительности

### openMenu
Функция для открытия меню и установки выбранного узла:
```javascript
const openMenu = useCallback((node) => {
  setSelectedNode(node);
  setMenuOpen(true);
}, []);
```

!> Используется мемоизация для оптимизации производительности

## Использование

Хук используется в основном компоненте App.js и других компонентах для управления UI состоянием:
```javascript
const { 
  menuOpen, setMenuOpen,
  selectedNode, setSelectedNode,
  rfInstance, setRfInstance,
  closeMenu, openMenu
} = useUI();
```

### Закрытие меню
```javascript
// Закрыть меню при смене уровня
useEffect(() => {
  closeMenu();
}, [currentLevel, closeMenu]);
```

### Открытие меню
```javascript
// Открыть меню при клике на узел
onNodeClick={(e, node) => openMenu(node)}
```

## Интеграция с другими компонентами

### ReactFlow
Используется для хранения инстанса ReactFlow:
```javascript
<ReactFlow
  onInit={setRfInstance}
  // ... другие props
/>
```

## Принципы работы

1. **Централизация** - вся логика управления UI состоянием в одном хуке
2. **Оптимизация** - использование useCallback для предотвращения лишних созданий функций
3. **Гибкость** - поддержка различных сценариев управления UI
4. **Совместимость** - совместимость с ReactFlow и другими компонентами

## Особенности реализации

!> Отсутствует валидация передаваемых узлов в функции openMenu
!> Жестко закодированное сброса selectedNode при закрытии меню
!> Отсутствует возможность частичного обновления состояния меню
!> Не предусмотрена обработка ошибок при работе с инстансом ReactFlow