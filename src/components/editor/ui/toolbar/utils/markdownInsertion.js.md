# markdownInsertion.js

## Назначение
Утилита для вставки markdown элементов в текстовое поле редактора с использованием стратегий.

## Экспортируемые компоненты
- `insertMarkdown` - основная функция вставки markdown элементов

## Структура
1. Импорты констант
2. Утилиты:
   - `calculateCursorOffset` - расчет смещения курсора
   - `getSelectedTextFromTextarea` - получение выделенного текста
3. Стратегии вставки markdown:
   - `hrStrategy` - для горизонтальной линии
   - `listHeaderWithSelectionStrategy` - для списков и заголовков с выделением
   - `listHeaderWithoutSelectionStrategy` - для списков и заголовков без выделения
   - `standardMarkdownStrategy` - стандартная стратегия для markdown
4. Функция `getMarkdownInsertionStrategy` для выбора стратегии
5. Основная функция `insertMarkdown`

## Взаимодействия
1. Принимает textarea элемент, тип markdown, функцию onChange и выделенный текст
2. Определяет позицию курсора и выделение
3. Получает фактический выделенный текст
4. Разбивает контент на части до и после курсора
5. Выбирает стратегию вставки в зависимости от типа markdown и наличия выделения
6. Применяет стратегию и получает результат
7. Вызывает onChange с новым контентом
8. Устанавливает позицию курсора с учетом смещения

## Зависимости
- `../../../constants` - для получения шаблонов и текстов по умолчанию

## Архитектура
Использует паттерн стратегия для обработки различных типов markdown элементов. Каждая стратегия отвечает за определенный тип markdown:

- `hrStrategy` обрабатывает вставку горизонтальной линии с учетом переносов строк
- `listHeaderWithSelectionStrategy` обрабатывает списки и заголовки с выделенным текстом
- `listHeaderWithoutSelectionStrategy` обрабатывает списки и заголовки без выделенного текста
- `standardMarkdownStrategy` обрабатывает стандартные markdown элементы (жирный, курсив, код, ссылки и т.д.)

Функция `insertMarkdown` реализует логику:
1. Проверяет наличие textarea
2. Фокусируется на textarea
3. Определяет позицию курсора и выделение
4. Получает фактический выделенный текст
5. Разбивает контент на части до и после курсора
6. Выбирает стратегию вставки
7. Применяет стратегию и получает результат
8. Вызывает onChange с новым контентом
9. Устанавливает позицию курсора с учетом смещения